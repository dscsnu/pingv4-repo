from typing import Dict, List, Optional, Tuple
import time
from pingv4 import AbstractBot, CellState, ConnectFourBoard


# --- Constants & Bitboard Logic ---

# Board dimensions: 7 columns x 6 rows
# Bitboard layout: 
# .  .  .  .  .  .  .
# 5 12 19 26 33 40 47
# 4 11 18 25 32 39 46
# 3 10 17 24 31 38 45
# 2  9 16 23 30 37 44
# 1  8 15 22 29 36 43
# 0  7 14 21 28 35 42
#
# Each column is 7 bits (6 rows + 1 buffer/guard bit at the top).
# Total bits: 7 * 7 = 49 bits. Fits in a 64-bit integer.

ROWS = 6
COLS = 7
BUFFERED_ROWS = ROWS + 1

class Bitboard:
    """
    Efficient Bitboard representation of a Connect Four board.
    Uses two 64-bit integers to represent the state for Red and Yellow.
    """
    __slots__ = ('mask', 'position', 'moves_count')

    def __init__(self, mask: int = 0, position: int = 0, moves_count: int = 0):
        self.mask = mask        # 1 where ANY piece exists
        self.position = position # 1 where CURRENT player has a piece
        self.moves_count = moves_count

    @classmethod
    def from_pingv4(cls, board: ConnectFourBoard) -> 'Bitboard':
        """Convert a pingv4 ConnectFourBoard to our Bitboard representation."""
        mask = 0
        position = 0
        moves_count = 0
        
        # pingv4 access: board[col, row]
        # Current player in pingv4 needs to be mapped to 'position'
        current_color = board.current_player
        
        for col in range(COLS):
            for row in range(ROWS):
                cell = board[col, row]
                if cell is not None:
                    moves_count += 1
                    shift = col * BUFFERED_ROWS + row
                    mask |= (1 << shift)
                    if cell == current_color:
                        position |= (1 << shift)
        
        return cls(mask, position, moves_count)

    def can_play(self, col: int) -> bool:
        """Check if a column is playable (guard bit is not set)."""
        # The top bit of the column (row 5) is at shift + 5.
        # But we use the mask to check. The mask will have the top bit set if full?
        # Actually standard check: (mask & top_mask(col)) == 0
        # Our top row for col C starts at C*7 + 5.
        # Wait, if we use a buffer row, checking if the Top Bit is 0 is safer.
        # Top bit index for col: col * 7 + 5. 
        # Actually simplest: (mask & (1 << (col * 7 + 5))) == 0
        return (self.mask & (1 << (col * 7 + 5))) == 0

    def make_move(self, col: int) -> 'Bitboard':
        """Return a new Bitboard with the move played in the given column."""
        # XOR trick: 
        # (mask + bottom_mask(col)) gives a carry that stops at the first 0.
        # It flips the bits up to the new piece.
        # The new piece position is (mask + bottom_mask(col)) ^ mask
        move_bit = (self.mask + (1 << (col * 7))) ^ self.mask
        
        new_mask = self.mask | move_bit
        
        # New position implies switching turns.
        # The stored 'position' is for the player whose turn it WAS.
        # The new 'position' should be for the NEXT player.
        # The new position will be: Opponent's pieces (which is mask ^ position)
        new_position = self.position ^ self.mask
        
        return Bitboard(new_mask, new_position, self.moves_count + 1)
        
    def is_win(self) -> bool:
        """Check if the *current* player (moves just played) has won."""
        # Wait, usually we check if the PREVIOUS move won.
        # In Negamax, we call check_win on the board state passed to us.
        # That state represents the board BEFORE the current player moves.
        # So we should check if the OPPONENT has 4 connected.
        # Opponent's pieces = position ^ mask.
        pos = self.position ^ self.mask
        
        # Horizontal
        m = pos & (pos >> 7)
        if m & (m >> 14): return True
        
        # Diagonal \
        m = pos & (pos >> 6)
        if m & (m >> 12): return True
        
        # Diagonal /
        m = pos & (pos >> 8)
        if m & (m >> 16): return True
        
        # Vertical
        m = pos & (pos >> 1)
        if m & (m >> 2): return True
        
        return False
        
    def count_threats(self) -> int:
        return 0

# --- Transposition Table ---
# --- Compressed Tablebase (Binary Delta) ---
class CompressedTablebase:
    def __init__(self):
        self.table = {}
        # TABLEBASE_DATA is defined at the end of the file
        if 'TABLEBASE_DATA' in globals():
            self._decode(globals()['TABLEBASE_DATA'])
        
    def _decode(self, data: bytes):
        idx = 0
        if len(data) < 13: return
        
        # Count (4 bytes LE)
        count = data[idx] | (data[idx+1] << 8) | (data[idx+2] << 16) | (data[idx+3] << 24)
        idx += 4
        
        # First Hash (8 bytes LE)
        current_hash = 0
        for i in range(8):
            current_hash |= (data[idx + i] << (8 * i))
        idx += 8
        
        # First Move
        self.table[current_hash] = data[idx]
        idx += 1
        
        # Deltas
        for _ in range(count - 1):
            if idx >= len(data): break
            # LEB128 Delta
            delta = 0
            shift = 0
            while True:
                if idx >= len(data): break
                byte = data[idx]
                idx += 1
                delta |= (byte & 0x7F) << shift
                if not (byte & 0x80):
                    break
                shift += 7
                
            current_hash += delta
            if idx >= len(data): break
            move = data[idx]
            idx += 1
            self.table[current_hash] = move

    def get(self, key: int) -> Optional[int]:
        return self.table.get(key)


class TranspositionTable:
    def __init__(self, size_mb: int = 64):
        self.table: Dict[int, Tuple[int, int, int, int]] = {}
        # Key: hash
        # Value: (depth, flag, score, best_move)

    def store(self, key: int, depth: int, flag: int, score: int, best_move: int):
        self.table[key] = (depth, flag, score, best_move)

    def lookup(self, key: int) -> Optional[Tuple[int, int, int, int]]:
        return self.table.get(key)


# --- Bot Implementation ---

class AS658(AbstractBot):
    @property
    def strategy_name(self) -> str:
        return "The fool"
    
    @property
    def author_name(self) -> str:
        return "Akshit Sivaraman"

    @property
    def author_netid(self) -> str:
        return "as658"

    def __init__(self, player: CellState) -> None:
        super().__init__(player)
        self.tt = TranspositionTable()
        self.start_time = 0.0
        self.time_limit = 6.5  # Max 6.5 seconds per move
        self.nodes_searched = 0
        
        # Move ordering optimized: Center columns first
        self.column_order = [3, 2, 4, 1, 5, 0, 6]
        
        # Load Tablebase
        self.book = CompressedTablebase()

    def get_valid_moves_ordered(self, bitboard: Bitboard) -> List[int]:
        valid = []
        for col in self.column_order:
            if bitboard.can_play(col):
                valid.append(col)
        return valid

    def get_move(self, board: ConnectFourBoard) -> int:
        self.start_time = time.time()
        self.nodes_searched = 0
        
        # 1. Convert to Bitboard
        bb = Bitboard.from_pingv4(board)

        # 1.5 Opening Book Lookup (Compressed Tablebase)
        # O(1) instant response for solved positions
        if self.book:
            book_move = self.book.get(board.hash)
            if book_move is not None:
                # verify legality just in case
                if bb.can_play(book_move):
                    return book_move
        
        # 2. Check for immediate winning move (Correctness)
        valid_moves = board.get_valid_moves()
        for col in valid_moves:
            next_bb = bb.make_move(col)
            # After make_move, the 'position' is the NEXT player.
            # So next_bb.is_win() checks if the PREVIOUS player (us) won.
            if next_bb.is_win():
                return col
        
        # 3. Iterative Deepening
        best_move = valid_moves[0]
        # Start deeper than 1 because 1 is trivial
        max_depth = 42 # Full board
        
        try:
            for depth in range(1, max_depth + 1):
                move, score = self.negamax(bb, depth, -1000000, 1000000, board.hash)
                
                # Time check
                msg = f"Depth {depth}: Move {move}, Score {score}, Time {time.time() - self.start_time:.3f}s"
                print(msg) 
                
                if time.time() - self.start_time > self.time_limit:
                    break
                    
                best_move = move
                
                # If we found a forced win, stop searching deeper
                if score >= 900000:
                    print(f"Forced win found at depth {depth}!")
                    break 
        except TimeoutError:
            print(f"Timeout reached at depth {depth}")
            pass # Return current best move
            
        return best_move

    def negamax(self, bb: Bitboard, depth: int, alpha: int, beta: int, board_hash: int) -> Tuple[int, int]:
        self.nodes_searched += 1
        
        # Check time every 2048 nodes to avoid invalid system call overhead
        if (self.nodes_searched & 2047) == 0:
             if (time.time() - self.start_time) > self.time_limit:
                 raise TimeoutError()

        # Hash table lookup can be done if we maintained a rolling hash.
        # However, we can use a simpler TT key: (bb.position, bb.mask) tuple
        tt_key = (bb.position, bb.mask)
        tt_entry = self.tt.lookup(tt_key)
        
        if tt_entry:
            tt_depth, tt_flag, tt_score, tt_move = tt_entry
            if tt_depth >= depth:
                if tt_flag == 0: # EXACT
                    return tt_move, tt_score
                elif tt_flag == 1: # LOWERBOUND
                    alpha = max(alpha, tt_score)
                elif tt_flag == 2: # UPPERBOUND
                    beta = min(beta, tt_score)
                
                if alpha >= beta:
                    return tt_move, tt_score

        # Check win for the previous player (opponent of current turn)
        if bb.is_win():
             return -1, -1000000 + (42 - depth) # Prefer faster limits
             
        if bb.moves_count == 42: # Draw
            return -1, 0

        if depth == 0:
            return -1, self.evaluate(bb)

        best_score = -10000000
        best_move = -1
        
        # Generate moves (column order)
        valid_moves = []
        for col in self.column_order:
             if bb.can_play(col):
                 valid_moves.append(col)
                 
        for col in valid_moves:
             new_bb = bb.make_move(col)
             
             # Recursion
             # Negate score
             _, score = self.negamax(new_bb, depth - 1, -beta, -alpha, 0)
             score = -score
             
             if score > best_score:
                 best_score = score
                 best_move = col
                 
             alpha = max(alpha, score)
             if alpha >= beta:
                 break
                 
        # Store in TT
        flag = 0 # EXACT
        if best_score <= alpha: flag = 2 # UPPERBOUND
        elif best_score >= beta: flag = 1 # LOWERBOUND
        
        self.tt.store(tt_key, depth, flag, best_score, best_move)
        
        return best_move, best_score

    def evaluate(self, bb: Bitboard) -> int:
        """
        Evaluate position using:
        1. Center Control
        2. Connected Streaks (Horizontal, Vertical, Diagonal)
        3. Simple Odd/Even Preference (Parity)
        """
        score = 0
        
        # Unpack
        pos = bb.position       # My pieces (Side to move)
        mask = bb.mask          # All pieces
        opp = mask ^ pos        # Opponent pieces
        
        # --- 1. Center Control ---
        # Column 3 is the most valuable.
        # Shift for col 3: 3 * 7 = 21. Guards at 5, 12...
        center_col_mask = 0b1111110 << 21  # 6 rows of center column
        my_center = bin(pos & center_col_mask).count('1')
        opp_center = bin(opp & center_col_mask).count('1')
        score += (my_center * 5) - (opp_center * 5)
        
        # --- 2. Streak Detection ---
        # We reward 3-in-a-row and 2-in-a-row significantly.
        # Directions: Vertical(1), Diagonal\(6), Horizontal(7), Diagonal/(8)
        directions = [1, 6, 7, 8]
        
        for d in directions:
             # -- My Streaks --
             # 2 consecutive
             my_2 = pos & (pos >> d)
             if my_2:
                 # 3 consecutive: (P P) & (P shifted twice) -> P P P
                 my_3 = my_2 & (pos >> (2 * d))
                 if my_3:
                     score += bin(my_3).count('1') * 20
                 
                 # Add score for 2s as well
                 score += bin(my_2).count('1') * 5
             
             # -- Opponent Streaks --
             opp_2 = opp & (opp >> d)
             if opp_2:
                 opp_3 = opp_2 & (opp >> (2 * d))
                 if opp_3:
                     # Penalize opp 3s heavily (almost a threat)
                     score -= bin(opp_3).count('1') * 25
                 
                 score -= bin(opp_2).count('1') * 6
        
        # --- 3. Parity Heuristic ---
        # Generally:
        # If I am Player 1 (Red), I love ODD rows (0, 2, 4) [1-based: 1,3,5] -> indices 0,2,4
        # If I am Player 2 (Yellow), I love EVEN rows (1, 3, 5) -> indices 1,3,5
        
        # How do I know if I am P1 or P2?
        # moves_count starts at 0.
        # If moves_count is Even (0, 2...), it is P1's turn to move.
        # So 'pos' belongs to P1.
        # If moves_count is Odd, it is P2's turn. 'pos' belongs to P2.
        
        is_p1 = (bb.moves_count % 2 == 0)
        
        # Parity Mask for Even Rows (0, 2, 4 in 0-indexed)
        # Row 0: bits 0, 7, 14...
        # Row 1: bits 1, 8, 15... (Odd rows)
        
        # Construct masks dynamically? Constant is better.
        # Rows 0, 2, 4 (Even indices)
        # Col 0: 1 (0), 4 (2), 16 (4) -> ...
        # Standard mask: 
        # valid row bits: 0,1,2,3,4,5.
        # even_rows = A (0) | C (2) | E (4).
        
        # Precomputed masks for efficiency (can be moved to constants later)
        # 0b0101010 per column (approx).
        # Actually in 7-bit column: 
        # Row 0: 1
        # Row 1: 2
        # Row 2: 4
        # Row 3: 8
        # Row 4: 16
        # Row 5: 32
        # Even Rows Mask (0, 2, 4): 1 | 4 | 16 = 21 (0x15)
        # Repating 7 times shifted by 7.
        
        # MASK_EVEN_ROWS
        m_even = 0
        for c in range(7):
            m_even |= (0x15 << (c * 7))
            
        # MASK_ODD_ROWS
        # Rows 1, 3, 5: 2 | 8 | 32 = 42 (0x2A)
        m_odd = 0
        for c in range(7):
            m_odd |= (0x2A << (c * 7))
            
        my_pieces_count = bin(pos).count('1') # Approximate check not needed, proceed to calculation
        
        if is_p1:
             # I am P1. I want pieces in Even Rows (0,2,4) - wait, standard theory says P1 wants ODD check (1,3,5 or 0,2,4?)
             # Let's assume P1 wants EVEN indices.
             
             my_good = pos & m_even
             score += bin(my_good).count('1') * 2
        else:
             # I am P2. I want pieces in ODD indices (Row 1, 3, 5).
             my_good = pos & m_odd
             score += bin(my_good).count('1') * 2
             
        return score
TABLEBASE_DATA = (b"\x4f\x05\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x02\x02\x02\x08\x02\x08\x02\x6d\x02\x08\x02\x02\x02\x73\x02\x01\x02\x03\x04\x01\x02\x03\x03\x01\x02\xf5\x01\x03\x02\x04\x02\x03\x01\x02\x7c\x02\x02\x02\x7c\x02\xff\x01\x03\x7f\x02\x7e\x02\xfd\x01\x02\x01\x02\xf7\x07\x03\x97\x6a\x02\x04\x03\x04\x02\x02\x02\xf2\x01\x02\x02\x02\x02\x02\x01\x02\xfb\x01\x02\x7f\x02\x7d\x02\x01\x02\xfb\x03\x02\xfe\x01\x02\x8d\x72\x02\x01\x03\x03\x05\x01\x02\x03\x03\x01\x03\x76\x02\x02\x02\x02\x02\x01\x02\x7b\x02\x02\x03\x7e\x02\x7d\x03\x01\x02\x7e\x02\x01\x02\xfc\x02\x03\x7f\x02\x8a\x77\x02\xfa\x03\x02\x87\x78\x03\x02\x05\x02\x03\x01\x03\x7c\x02\x7d\x03\x01\x03\xfd\x01\x03\x7f\x02\x88\x79\x03\x02\x02\x7d\x02\x7d\x02\x01\x02\xfd\x01\x02\x86\x7a\x02\x02\x03\x7c\x02\x01\x02\xfd\x01\x02\x87\xf9\x01\x03\xfc\x01\x03\x85\x7c\x02\xfc\x01\x02\x84\x7c\x03\x7e\x02\x83\xfb\x01\x02\x01\x03\x7e\x02\x89\xef\x07\x03\xed\xaa\x69\x03\x08\x03\x02\x03\xf2\x01\x03\x02\x03\x02\x03\x01\x03\xfb\x01\x03\x7f\x03\x7d\x03\x01\x03\xfb\x03" 
 b"\x03\xfe\x01\x03\x8d\x74\x03\xfa\x03\x03\x87\x78\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x03\x01\x03\xfd\x01\x03\x7f\x03\x89\xf7\x01\x03\xfc\x01\x03\x85\x7c\x02\xfc\x01\x03\x83\x7c\x03\x01\x03\x7e\x03\x85\xf7\x03\x03\x82\xfc\x01\x03\xf3\x9a\x71\x03\x01\x03\x03\x03\x01\x03\x03\x03\x01\x03\x76\x03\x02\x03\x02\x03\x01\x03\x7b\x03\x02\x03\x7e\x03\x7d\x02\x01\x03\x7e\x03\x01\x03\xfc\x02\x04\x7f\x03\x8a\x75\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x03\x01\x03\xfd\x01\x03\x7f\x03\x87\x79\x02\x02\x02\x7c\x03\x01\x03\xfd\x01\x03\x86\x7b\x03\xfc\x01\x03\x83\x7c\x02\x01\x02\x7e\x03\x82\x7d\x03\x01\x03\x7e\x03\x84\xf9\x02\x02\x81\x7e\x03\xf6\x96\x74\x03\xfa\x03\x03\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x03\xf9\x8e\x77\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7e\x03\xfd\x01\x04\x7f\x03\x88\x79\x03\xfc\x01\x03\x84\x7c\x02\x7e\x03\x83\xfb\x01\x02\x81\x7e\x03\xfc\x8c\x78\x03\x02\x03\x7d\x03\x7d\x03\x01\x03\xfd\x01\x03\x87\x7a\x02\xfc\x01\x03\x83\x7c\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfc\x8a\x79\x03\x02" 
 b"\x03\x7c\x03\x01\x03\xfd\x01\x03\x84\x7b\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfd\x8b\xf7\x01\x03\xfc\x01\x04\x84\xfa\x01\x02\xff\x86\x7b\x03\xfc\x01\x03\x84\xfa\x01\x03\xfe\x86\x7b\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\x01\x03\x7e\x03\x82\x7d\x03\xf7\x99\xe7\x07\x03\x97\xc0\xc1\x68\x04\x04\x03\x04\x04\x02\x04\xf2\x01\x04\x02\x03\x02\x03\x01\x04\xfb\x01\x03\x7f\x04\x7d\x03\x01\x04\xfb\x03\x04\xfe\x01\x04\x8d\x74\x01\xfa\x03\x01\x87\x78\x02\x02\x05\x02\x05\x01\x02\x7c\x02\x7d\x06\x01\x02\xfd\x01\x06\x7f\x02\x89\xf7\x01\x03\x81\x7e\x03\xfc\x01\x01\x83\x7c\x02\x01\x02\x7e\x02\x85\xf7\x03\x02\x82\xfc\x01\x02\xf3\x9c\x71\x04\xfa\x03\x04\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x03\xf9\x8e\x77\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x03\x01\x03\xfc\x02\x03\x88\x79\x03\xfc\x01\x03\x84\x7c\x03\x7e\x03\x84\xf9\x02\x03\xfb\x8f\xf5\x01\x03\xff\x82\x7d\x04\xfc\x01\x04\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfb\x8d\xf3\x03\x03\xfe\x85\xfa\x01\x03\x8d\xd8\xa9\x70\x04\x01\x03" 
 b"\x03\x04\x01\x04\x03\x03\x01\x03\x76\x03\x02\x04\x02\x03\x01\x03\x7b\x04\x02\x03\x7e\x03\x7d\x04\x01\x03\x7e\x04\x01\x03\xfc\x02\x03\x7f\x03\x8a\x75\x02\x02\x02\x02\x02\x01\x05\x7c\x02\x7d\x02\x01\x02\xfd\x01\x02\x7f\x01\x87\x79\x03\x02\x03\x7c\x01\x01\x03\xfd\x01\x03\x86\x7b\x02\xfc\x01\x02\x83\x7c\x03\x01\x03\x7e\x01\x82\x7d\x02\x01\x05\x7e\x01\x84\xf9\x02\x03\x81\x7e\x02\xf6\x94\x74\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x03\x01\x03\xfd\x01\x03\x7f\x03\x88\x79\x03\xfc\x01\x03\x83\x7c\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfc\x8a\x79\x04\x02\x04\x7c\x04\x01\x01\xfd\x01\x01\x84\x7b\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfe\x88\x7a\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x04\x01\x04\x7e\x01\x82\x7d\x03\xfe\x84\x7c\x03\x01\x03\x7e\x03\x82\x7d\x03\xfc\x8a\xf6\x02\x04\xff\x82\x7d\x03\x8a\xe3\xa0\x73\x04\xfa\x03\x04\x8a\xf6\x01\x02\xfc\x01\x06\x86\xf6\x03\x02\xfa\x91\xf4\x01\x03\xfc\x01\x03\xfe\x89\xf4\x03\x03\x87\xea\x97\x76\x03\x02\x04\x02\x03\x01\x03\x7c\x01\x7d\x04\x01\x03\xfd\x01\x03" 
 b"\x7f\x01\x88\x79\x02\xfc\x01\x02\x83\x7c\x03\x01\x03\x7e\x01\x83\xfb\x01\x03\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x04\x01\x04\x7e\x01\x82\x7d\x03\xfd\x87\xf9\x01\x04\xff\x82\x7d\x03\x88\xed\x94\x77\x03\x02\x04\x7d\x04\x7d\x01\x01\x04\xfd\x01\x04\x87\x7a\x03\xfc\x01\x02\x83\x7c\x02\x01\x02\x7e\x02\x83\xfb\x01\x02\xfd\x8a\x79\x04\xfc\x01\x04\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\x86\xf0\x91\x78\x04\x02\x03\x7c\x04\x01\x03\xfd\x01\x03\x84\x7b\x02\x01\x02\x7e\x01\x83\xfb\x01\x02\xfc\x88\x7a\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\x87\xef\x94\xf5\x01\x03\xfc\x01\x04\x84\xfa\x01\x03\xfc\x89\xf8\x01\x04\x85\xf6\x8b\x7a\x04\xfc\x01\x02\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x84\xf6\x8b\x7a\x03\x7e\x03\x82\x7d\x02\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x04\x01\x03\x7e\x03\x82\x7d\x02\xfe\x84\x7c\x03\x89\xdd\xb2\xdf\x07\x03\xed\xd4\xfe\xd8\x67\x02\x04\x03\x04\x02\x02\x02\xf2\x01\x03\x02\x03\x02\x03\x01\x02\xfb\x01\x03" 
 b"\x7f\x02\x7d\x03\x01\x02\xfb\x03\x03\xfe\x01\x03\x8d\x74\x02\xfa\x03\x02\x87\x78\x03\x02\x05\x02\x03\x01\x02\x7c\x02\x7d\x03\x01\x03\xfd\x01\x03\x7f\x02\x89\xf7\x01\x03\xfc\x01\x03\x85\x7c\x02\xfc\x01\x02\x83\x7c\x02\x01\x02\x7e\x02\x85\xf7\x03\x03\x82\xfc\x01\x03\xf3\x9c\x71\x02\xfa\x03\x02\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x03\xf9\x8e\x77\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x02\x01\x03\xfd\x01\x04\x7f\x03\x88\x79\x03\xfc\x01\x03\x83\x7c\x02\x01\x03\x7e\x03\x83\xfb\x01\x05\x81\x7e\x03\xfb\x8f\xf5\x01\x03\xfc\x01\x04\x84\xfa\x01\x05\xff\x86\x7b\x02\xfc\x01\x02\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfb\x8d\xf3\x03\x03\xfe\x85\xfa\x01\x03\x8d\xda\xa9\x70\x03\xfa\x03\x04\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x01\xfa\x91\xf4\x01\x03\xfc\x01\x03\xfe\x89\xf4\x03\x03\x87\xea\x97\x76\x02\x02\x02\x02\x02\x01\x02\x7c\x02\x7d\x04\x01\x03\xfd\x01\x03\x7f\x02\x88\x79\x02\xfc\x01\x02\x83\x7c\x05\x01\x03\x7e\x02\x83\xfb\x01\x05\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03" 
 b"\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\xff\x82\x7d\x03\x89\xe9\x9a\xf3\x01\x02\xfc\x01\x04\x84\xfa\x01\x05\xfc\x89\xf8\x01\x03\x85\xf6\x8b\x7a\x04\xfc\x01\x04\x84\xfa\x01\x05\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x85\xed\x9a\xef\x03\x02\x82\xf8\x8b\xf8\x01\x02\xf3\xb4\xae\xb9\x6f\x02\x01\x03\x03\x02\x01\x02\x03\x03\x01\x03\x76\x03\x02\x02\x02\x03\x01\x03\x7b\x02\x80\x01\x03\x7d\x02\x01\x03\x7e\x04\x01\x03\xfc\x02\x03\x7f\x03\x8a\x75\x02\x02\x02\x02\x02\x01\x05\x7c\x02\x7d\x02\x01\x02\xfd\x01\x02\x7f\x03\x87\x79\x02\x02\x03\x7c\x02\x01\x03\xfd\x01\x02\x86\x7b\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x03\x82\x7d\x05\x01\x05\x7e\x03\x84\xf9\x02\x03\x81\x7e\x02\xf6\x94\x74\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x03\x01\x03\xfd\x01\x03\x7f\x02\x88\x79\x03\xfc\x01\x03\x83\x7c\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfc\x8a\x79\x02\x02\x02\x7c\x02\x01\x02\xfd\x01\x02\x84\x7b\x03\x01\x03\x7e\x03\x83\xfb\x01\x03" 
 b"\xfe\x88\x7a\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x02\x01\x02\x7e\x02\x82\x7d\x03\xfe\x84\x7c\x03\x01\x03\xfc\x88\xf7\x02\x02\xff\x82\x7d\x03\x8a\xe1\xa0\x73\x02\x02\x02\x02\x02\x01\x02\x7c\x04\x7d\x02\x01\x02\xfd\x01\x02\x7f\x04\x88\x79\x05\xfc\x01\x02\x83\x7c\x02\x01\x02\x7e\x02\x83\xfb\x01\x02\x81\x7e\x04\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\xff\x82\x7d\x03\x87\xed\x94\x77\x03\x02\x03\x7c\x03\x01\x03\xfd\x01\x03\x84\x7b\x00\x01\x03\x7e\x03\x83\xfb\x01\x00\xfc\x88\x7a\x03\x01\x03\xfd\x85\xfa\x01\x03\x86\xf3\x8e\x79\x02\xfc\x01\x02\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x03\x01\x03\x7e\x03\x82\x7d\x00\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x02\x01\x02\x7e\x04\x82\x7d\x05\xfe\x84\x7c\x03\x84\xf1\x94\xf3\x02\x03\x81\xfc\x85\x7c\x02\xf6\xaa\xc0\xad\x72\x03\xfa\x03\x03\x8a\xf6\x01\x02\xfc\x01\x03\x86\xf6\x03\x02\xfa\x91\xf4\x01\x03\xfc\x01\x04\x84\xfa\x01\x05\xfa\x8f\xf2\x03\x03\x8a\xe6\x9d\xf2\x01\x02\xfc" 
 b"\x01\x04\x84\xfa\x01\x05\xfc\x89\xf8\x01\x03\x86\xea\x9d\xee\x03\x02\xf9\x9c\xd2\xa1\x75\x03\x02\x02\x02\x03\x01\x03\x7c\x03\x7d\x02\x01\x03\xfd\x01\x03\x7f\x03\x88\x79\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x03\x83\xfb\x01\x03\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x02\x01\x02\x7e\x02\x82\x7d\x03\xfd\x87\xf9\x01\x02\xff\x82\x7d\x03\x88\xed\x94\x77\x02\xfc\x01\x02\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x03\x01\x03\x7e\x03\x82\x7d\x00\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x03\x81\xfc\x85\x7c\x02\xfc\x98\xd8\x9d\x76\x03\x02\x02\x7d\x02\x7d\x03\x01\x02\xfd\x01\x03\x87\x7a\x02\xfc\x01\x02\x83\x7c\x02\x01\x02\x7e\x02\x83\xfb\x01\x05\xfd\x8a\x79\x02\xfc\x01\x02\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\x87\xf0\x91\x78\x03\xfc\x01\x03\x84\xfa\x01\x00\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x02\xfc\x94\xde\x99\x77\x02\x02\x03\x7c\x03\x01\x03\xfd\x01\x03" 
 b"\x84\x7b\x02\x01\x02\x7e\x02\x83\xfb\x01\x02\xfc\x88\x7a\x03\x01\x03\x7e\x02\x82\x7d\x05\xfd\x87\xf9\x01\x03\x84\xf3\x8e\x79\x02\x01\x02\x7e\x04\x82\x7d\x01\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x02\xfd\x95\xda\x9f\xf3\x01\x03\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x02\x84\xf2\x91\xf6\x01\x03\xff\x8c\xea\x91\x79\x02\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x02\xfe\x8c\xea\x91\x79\x03\x7e\x03\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x02\xfd\x8d\xe6\x97\xf5\x01\x02\x01\x03\x7e\x03\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x02\xf7\xab\xaa\xd3\xd7\x07\x03\x97\x96\xd6\xa5\xf1\x66\x02\x08\x02\x02\x02\xf2\x01\x03\x02\x04\x02\x03\x01\x02\xfb\x01\x03\x7f\x02\x7d\x02\x01\x02\xfb\x03\x03\xfe\x01\x03\x8d\x74\x02\xfa\x03\x02\x87\x78\x03\x02\x05\x02\x03\x01\x03\x7c\x02\x7d\x03\x01\x03\xfd\x01\x03\x7f\x02\x89\xf7\x01\x03\xfc\x01\x03\x85\x7c\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x02\x85\xf7\x03\x03\x82\xfc\x01\x03\xf3\x9c\x71\x03\xfa\x03\x03\x8a\xf6\x01\x03\xfc\x01" 
 b"\x03\x86\xf6\x03\x03\xf9\x8e\x77\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x02\x01\x03\xfd\x01\x04\x7f\x03\x88\x79\x03\xfc\x01\x03\x83\x7c\x02\x01\x02\x7e\x03\x83\xfb\x01\x02\x81\x7e\x03\xfb\x8f\xf5\x01\x03\xfc\x01\x04\x84\xfa\x01\x02\xff\x86\x7b\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfb\x8d\xf3\x03\x03\xfe\x85\xfa\x01\x03\x93\xd8\xa9\x70\x01\xfa\x01\x03\xfa\x03\x01\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x04\xfa\x91\xf4\x01\x03\xfa\x8b\xf4\x03\x03\x87\xea\x97\x76\x03\x02\x04\x02\x03\x01\x03\x7c\x02\x7d\x04\x01\x03\xfd\x01\x03\x7f\x02\x88\x79\x02\xfc\x01\x02\x83\x7c\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x04\x01\x04\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x04\xff\x82\x7d\x03\x89\xe9\x9a\xf3\x01\x03\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x04\x85\xf6\x8b\x7a\x01\xfc\x01\x01\x84\xfa\x01\x01\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x04\x01\x03\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x85\xed\x9a\xef" 
 b"\x03\x03\x82\xf8\x8b\xf8\x01\x03\xf3\xb6\xae\xb9\x6f\x03\xfa\x03\x03\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x03\xfa\x91\xf4\x01\x03\xfc\x01\x04\x84\xfa\x01\x05\xfa\x8f\xf2\x03\x03\x8a\xe6\x9d\xf2\x01\x02\xfc\x01\x04\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x86\xea\x9d\xee\x03\x02\xf9\x9c\xd2\xa1\x75\x02\x02\x02\x02\x03\x01\x02\x7c\x02\x7d\x02\x01\x02\xfd\x01\x03\x7f\x02\x88\x79\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x03\x83\xfb\x01\x03\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\xff\x82\x7d\x03\x88\xed\x94\x77\x02\xfc\x01\x02\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x04\x01\x04\x7e\x04\x82\x7d\x02\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x03\x81\xfc\x85\x7c\x02\xfb\x9d\xce\xa7\xf1\x01\x03\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x04\xff\x8c\xea\x91\x79\x02\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x02\xfd\x8c\xea\x91\x79\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe" 
 b"\x84\x7c\x03\x82\xf9\x88\x7b\x02\xfb\x97\xd2\xab\xeb\x03\x02\xfe\x89\xec\x93\xf6\x01\x02\x8d\xbe\x86\xf5\xc9\x6e\x02\x01\x02\x03\x02\x01\x02\x04\x02\x76\x02\x02\x02\x02\x02\x01\x04\x7b\x02\x80\x01\x02\x7d\x02\x01\x03\x7e\x04\x01\x04\xfc\x02\x03\x7f\x02\x8a\x75\x02\x02\x03\x02\x02\x01\x05\x7c\x02\x7d\x02\x01\x02\xfd\x01\x02\x7f\x03\x87\x79\x02\x7e\x02\x01\x02\xfd\x01\x02\x86\x7b\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x02\x82\x7d\x03\x01\x05\x7e\x03\x84\xf9\x02\x03\x81\x7e\x02\xf6\x94\x74\x03\x02\x03\x02\x03\x01\x03\x7c\x03\x7d\x03\x01\x03\xfd\x01\x03\x7f\x02\x88\x79\x02\xfc\x01\x03\x83\x7c\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\x81\x7e\x02\xfb\x8c\x78\x03\x02\x03\x7c\x03\x01\x03\xfd\x01\x03\x84\x7b\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfe\x88\x7a\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfe\x84\x7c\x03\x01\x03\xfc\x88\xf7\x02\x03\xff\x82\x7d\x03\x8a\xe1\xa0\x73\x04\x02\x03\x02\x04\x01\x04\x7c\x04\x7d\x02\x01\x02\xfd\x01\x02\x7f\x04\x88\x79\x03\xfc\x01\x01" 
 b"\x83\x7c\x02\x01\x02\x7e\x02\x83\xfb\x01\x02\x81\x7e\x03\xfc\x8c\x78\x04\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\xff\x82\x7d\x04\x87\xed\x94\x77\x01\x02\x03\x7c\x01\x01\x03\xfd\x01\x03\x84\x7b\x01\x01\x03\x7e\x03\x83\xfb\x01\x01\xfc\x88\x7a\x03\x01\x03\x7e\x03\xff\x84\xfa\x01\x03\x86\xf3\x8e\x79\x04\xfc\x01\x02\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x01\x01\x03\x7e\x03\x82\x7d\x03\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x03\x01\x04\x7e\x04\x82\x7d\x03\xfe\x84\x7c\x04\x84\xf1\x94\xf3\x02\x01\x81\xfc\x85\x7c\x04\xf6\xa8\xc0\xad\x72\x02\x02\x02\x02\x02\x01\x02\x7c\x02\x7d\x02\x01\x02\xfd\x01\x03\x7f\x02\x88\x79\x02\xfc\x01\x02\x83\x7c\x02\x01\x02\x7e\x02\x83\xfb\x01\x05\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\xff\x82\x7d\x03\x88\xed\x94\x77\x04\xfc\x01\x04\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03" 
 b"\x83\xf5\x8e\xf7\x01\x02\x81\xfc\x85\x7c\x04\xfb\x98\xd8\x9d\x76\x02\x02\x03\x7c\x03\x01\x03\xfd\x01\x03\x84\x7b\x03\x01\x03\x7e\x03\x83\xfb\x01\x03\xfc\x88\x7a\x03\x01\x03\x7e\x02\x82\x7d\x02\xfd\x87\xf9\x01\x03\x84\xf3\x8e\x79\x02\x01\x02\x7e\x04\x82\x7d\x05\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x02\xfe\x90\xe4\x95\x78\x02\xfc\x01\x03\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x02\xfd\x8c\xea\x91\x79\x02\x01\x03\x7e\x03\x82\x7d\x03\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x02\xfe\x88\xf0\x8d\x7a\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x04\xfc\x92\xdc\xa1\xf0\x02\x03\xff\x84\xf6\x89\x7b\x02\x8a\xcf\xe8\x92\xbb\x71\x03\xfa\x03\x03\x8a\xf6\x01\x03\xfc\x01\x03\x86\xf6\x03\x03\xfa\x91\xf4\x01\x03\xfc\x01\x04\x84\xfa\x01\x02\xfa\x8f\xf2\x03\x03\x8a\xe6\x9d\xf2\x01\x03\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x04\x86\xea\x9d\xee\x03\x03\xfa\xa1\xc8\xab\xf0\x01\x03\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x04\xfa\x9b\xcc\xaf\xea\x03\x02" 
 b"\x87\xdc\xca\xb0\xac\x74\x02\x02\x02\x02\x02\x01\x02\x7c\x02\x7d\x02\x01\x03\xfd\x01\x03\x7f\x02\x88\x79\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x02\x83\xfb\x01\x03\x81\x7e\x02\xfc\x8c\x78\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\xff\x82\x7d\x03\x88\xed\x94\x77\x04\xfc\x01\x02\x84\xfa\x01\x02\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x01\x01\x03\x7e\x03\x82\x7d\x01\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x03\x81\xfc\x85\x7c\x04\xfc\x98\xd8\x9d\x76\x02\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x02\xfd\x8c\xea\x91\x79\x02\x01\x03\x7e\x03\x82\x7d\x03\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x02\xfd\x8d\xe6\x97\xf5\x01\x03\xff\x84\xf6\x89\x7b\x02\x88\xe1\xc0\xba\xa7\x75\x02\x02\x02\x7d\x02\x7d\x02\x01\x02\xfd\x01\x03\x87\x7a\x02\xfc\x01\x02\x83\x7c\x02\x01\x03\x7e\x02\x83\xfb\x01\x03\xfd\x8a\x79\x03\xfc\x01\x03\x84\xfa\x01\x03\xfd\x86\x7b\x03\x01\x03\x7e\x03\x82\x7d\x03\xfd\x87\xf9\x01\x03\x87\xf0\x91\x78\x01\xfc\x01\x01\x84\xfa" 
 b"\x01\x01\xfc\x89\xf8\x01\x03\x83\xf6\x8b\x7a\x04\x01\x03\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x83\xf5\x8e\xf7\x01\x03\xfd\x94\xde\x99\x77\x02\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x02\xfd\x8c\xea\x91\x79\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x02\xfd\x8d\xe6\x97\xf5\x01\x02\x86\xe6\xb6\xc4\xa2\x76\x02\x7e\x03\x01\x04\x81\x7d\x03\x01\x05\x7e\x02\x83\xfb\x01\x02\xfc\x88\x7a\x03\xfe\x85\xfa\x01\x03\x84\xf3\x8e\x79\x03\x01\x04\x7e\x04\x82\x7d\x03\xfe\x84\x7c\x04\x83\xf5\x8e\xf7\x01\x04\xfc\x90\xe4\x95\x78\x02\x7f\x02\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x04\xfd\x8d\xe6\x97\xf5\x01\x02\x87\xe5\xbb\xba\xac\xf1\x01\x02\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x03\xfc\x91\xe0\x9b\xf4\x01\x03\x85\xf0\xa2\xd8\x98\x78\x02\xfc\x01\x03\x84\xfa\x01\x03\xfc\x89\xf8\x01\x03\x84\xf2\x91\xf6\x01\x03\xfc\x91\xe0\x9b\xf4\x01\x02\x84\xf0\xa2\xd8\x98\x78\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x04\xfe\x88" 
 b"\xf0\x8d\x7a\x02\x83\xef\xa7\xce\xa2\xf3\x01\x02\x01\x02\x7e\x02\x82\x7d\x02\xfe\x84\x7c\x03\x82\xf9\x88\x7b\x04\xfe\x88\xf0\x8d\x7a\x02\x89\xcb\x81\xd7\xfb\xcf\x07\x02")